(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/cashier"],{"4baf":function(t,e,n){"use strict";n.r(e);var o=n("6c31"),a=n("957d");for(var c in a)"default"!==c&&function(t){n.d(e,t,(function(){return a[t]}))}(c);n("bfbe");var r,i=n("f0c5"),s=Object(i["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);e["default"]=s.exports},"4e6c":function(t,e,n){"use strict";(function(t){n("fabc");o(n("66fd"));var e=o(n("4baf"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"6c31":function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c},c=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return o}))},"957d":function(t,e,n){"use strict";n.r(e);var o=n("fe1e"),a=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,(function(){return o[t]}))}(c);e["default"]=a.a},bfbe:function(t,e,n){"use strict";var o=n("f2b3"),a=n.n(o);a.a},f2b3:function(t,e,n){},fe1e:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("4795"));function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,o,a,c,r){try{var i=t[c](r),s=i.value}catch(u){return void n(u)}i.done?e(s):Promise.resolve(s).then(o,a)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var r=t.apply(e,n);function i(t){c(r,o,a,i,s,"next",t)}function s(t){c(r,o,a,i,s,"throw",t)}i(void 0)}))}}var i={data:function(){return{uid:"",token:"",type:"",platform:"",contact:"",money:"",orderno:"",loading:!1,price:.01,providerList:[]}},onLoad:function(e){this.platform=t.getSystemInfoSync().platform;var n=t.getStorageSync("userInfo");""!=n&null!=n&void 0!=n&&(this.uid=n.uid,this.token=n.token),this.contact=e.contact,this.orderno=e.orderId,this.money=e.money,this.getProviders()},methods:{to:function(t){},radioChange:function(t){this.type=t.detail.value,"rest"==this.type?this.restPay():this.requestPayment(this.type)},getProviders:function(){},weixinPay:function(){var e=this;console.log("发起支付"),this.loading=!0,t.login({success:function(n){console.log("login success",n),t.request({url:"https://unidemo.dcloud.net.cn/payment/wx/mp?code=".concat(n.code,"&amount=").concat(e.price),success:function(n){if(console.log("pay request success",n),200===n.statusCode)if(0===n.data.ret){console.log("得到接口prepay_id",n.data.payment);var o=n.data.payment;t.requestPayment({timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:"MD5",paySign:o.paySign,success:function(e){t.showToast({title:"感谢您的赞助!"})},fail:function(e){t.showModal({content:"支付失败,原因为: "+e.errMsg,showCancel:!1})},complete:function(){e.loading=!1}})}else t.showModal({content:n.data.desc,showCancel:!1});else t.showModal({content:"支付失败，请重试！",showCancel:!1})},fail:function(n){console.log("fail",n),e.loading=!1,t.showModal({content:"支付失败,原因为: "+n.errMsg,showCancel:!1})}})},fail:function(n){console.log("fail",n),e.loading=!1,t.showModal({content:"支付失败,原因为: "+n.errMsg,showCancel:!1})}})},requestPayment:function(e){var n=this;return r(o.default.mark((function a(){var c;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n.loading=!0,o.next=3,n.getOrderInfo(e);case 3:if(c=o.sent,console.log(c),console.log("得到订单信息",c),200===c.statusCode){o.next=10;break}return console.log("获得订单信息失败",c),t.showModal({content:"获得订单信息失败",showCancel:!1}),o.abrupt("return");case 10:t.requestPayment({provider:e,orderInfo:c.data,success:function(e){console.log("success",e),t.showToast({title:"感谢您的赞助!"})},fail:function(e){console.log("fail",e),t.showModal({content:"支付失败,原因为: "+e.errMsg,showCancel:!1})},complete:function(){n.loading=!1}});case 11:case"end":return o.stop()}}),a)})))()},getOrderInfo:function(e){var n="",o="https://demo.dcloud.net.cn/payment/?payid="+e+"&appid="+n+"&total="+this.price;return new Promise((function(e){t.request({url:o,success:function(t){e(t)},fail:function(t){e(t)}})}))},restPay:function(){this.$loading();var e=this,n={uid:this.uid,token:this.token,orderno:this.orderno},o="&r=api.member.order.pay";this.$apiPost(o,n).then((function(n){t.hideLoading(),e.$msg("支付成功"),t.$emit("updateOrder"),setTimeout((function(){t.redirectTo({url:"./payResult?contact="+e.contact+"&money="+e.money+"&orderno="+e.orderno})}),1e3)}))}}};e.default=i}).call(this,n("543d")["default"])}},[["4e6c","common/runtime","common/vendor"]]]);