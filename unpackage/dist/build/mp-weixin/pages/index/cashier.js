(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/cashier"],{"4baf":function(n,t,e){"use strict";e.r(t);var o=e("5a73"),i=e("957d");for(var r in i)"default"!==r&&function(n){e.d(t,n,(function(){return i[n]}))}(r);e("bfbe");var a,c=e("f0c5"),u=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);t["default"]=u.exports},"4e6c":function(n,t,e){"use strict";(function(n){e("fabc");o(e("66fd"));var t=o(e("4baf"));function o(n){return n&&n.__esModule?n:{default:n}}n(t.default)}).call(this,e("543d")["createPage"])},"5a73":function(n,t,e){"use strict";var o,i=function(){var n=this,t=n.$createElement;n._self._c},r=[];e.d(t,"b",(function(){return i})),e.d(t,"c",(function(){return r})),e.d(t,"a",(function(){return o}))},"957d":function(n,t,e){"use strict";e.r(t);var o=e("fe1e"),i=e.n(o);for(var r in o)"default"!==r&&function(n){e.d(t,n,(function(){return o[n]}))}(r);t["default"]=i.a},bfbe:function(n,t,e){"use strict";var o=e("f2b3"),i=e.n(o);i.a},f2b3:function(n,t,e){},fe1e:function(n,t,e){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(e("4795"));function i(n){return n&&n.__esModule?n:{default:n}}function r(n,t,e,o,i,r,a){try{var c=n[r](a),u=c.value}catch(s){return void e(s)}c.done?t(u):Promise.resolve(u).then(o,i)}function a(n){return function(){var t=this,e=arguments;return new Promise((function(o,i){var a=n.apply(t,e);function c(n){r(a,o,i,c,u,"next",n)}function u(n){r(a,o,i,c,u,"throw",n)}c(void 0)}))}}var c={data:function(){return{uid:"",token:"",type:"",platform:"",contact:"",money:"",orderno:"",loading:!1,price:.01,providerList:[]}},onLoad:function(t){this.platform=n.getSystemInfoSync().platform;var e=n.getStorageSync("userInfo");""!=e&null!=e&void 0!=e&&(this.uid=e.uid,this.token=e.token),this.contact=t.contact,this.orderno=t.orderId,this.money=t.money,this.getProviders()},methods:{to:function(n){},radioChange:function(t){var e=this;if(this.type=t.detail.value,"rest"==this.type)this.restPay();else{var o=this.providerList.filter((function(n){return n.id==e.type}))[0].name;n.showModal({title:"提示",content:"确认使用"+o+"支付吗",success:function(n){n.confirm&&e.requestPayment(e.type)}})}},getProviders:function(){},weixinPay:function(){var t=this;console.log("发起支付"),this.loading=!0,n.login({success:function(e){console.log("login success",e),n.request({url:"https://unidemo.dcloud.net.cn/payment/wx/mp?code=".concat(e.code,"&amount=").concat(t.price),success:function(e){if(console.log("pay request success",e),200===e.statusCode)if(0===e.data.ret){console.log("得到接口prepay_id",e.data.payment);var o=e.data.payment;n.requestPayment({timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:"MD5",paySign:o.paySign,success:function(t){n.showToast({title:"感谢您的赞助!"})},fail:function(t){n.showModal({content:"支付失败",showCancel:!1})},complete:function(){t.loading=!1}})}else n.showModal({content:e.data.desc,showCancel:!1});else n.showModal({content:"支付失败，请重试！",showCancel:!1})},fail:function(e){console.log("fail",e),t.loading=!1,n.showModal({content:"支付失败",showCancel:!1})}})},fail:function(e){console.log("fail",e),t.loading=!1,n.showModal({content:"支付失败",showCancel:!1})}})},requestPayment:function(t){var e=this;return a(o.default.mark((function i(){var r,a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return r=e,e.$loading(),e.loading=!0,o.next=5,e.getOrderInfo(t);case 5:a=o.sent,console.log(a),n.requestPayment({provider:t,orderInfo:a.data,success:function(t){n.$emit("updateOrder"),setTimeout((function(){n.redirectTo({url:"./payResult?contact="+r.contact+"&money="+r.money+"&orderno="+r.orderno})}),1e3)},fail:function(t){n.showModal({content:"支付失败",showCancel:!1})},complete:function(){e.loading=!1}});case 8:case"end":return o.stop()}}),i)})))()},getOrderInfo:function(t){var e="http://yuying.qinshaozhuanshu.cn/app/index.php?i=2&c=entry&m=zhonghong_zhihui&do=mobile&r=api.member.order.payOrder",o={uid:this.uid,token:this.token,type:t,orderno:this.orderno};return new Promise((function(t){n.request({url:e,data:o,success:function(e){n.hideLoading(),t(e)},fail:function(e){n.hideLoading(),t(e)}})}))},restPay:function(){this.$loading();var t=this,e={uid:this.uid,token:this.token,orderno:this.orderno},o="&r=api.member.order.pay";this.$apiPost(o,e).then((function(e){n.hideLoading(),t.$msg("支付成功"),n.$emit("updateOrder"),setTimeout((function(){n.redirectTo({url:"./payResult?contact="+t.contact+"&money="+t.money+"&orderno="+t.orderno})}),1e3)}))}}};t.default=c}).call(this,e("543d")["default"])}},[["4e6c","common/runtime","common/vendor"]]]);