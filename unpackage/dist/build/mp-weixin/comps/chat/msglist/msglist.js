(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["comps/chat/msglist/msglist"],{1763:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){Promise.all([n.e("common/vendor"),n.e("comps/chat/msglist/type/audio/audio")]).then(function(){return resolve(n("50ed"))}.bind(null,n)).catch(n.oe)},o=n("7657"),r=n("ac99"),s={SHORT:"scroll_view_change",NORMAL:"scroll_view"},a=0,c="",u=!1,l={components:{audioMsg:i},props:{username:{type:Object,value:{}}},data:function(){return{view:s.NORMAL,toView:"",chatMsg:[],visibility:!1,scrollTop:99999}},beforeMount:function(){this.visibility=!0,0,a=0},beforeDestroy:function(){this.visibility=!1},created:function(){this.create_or_onready()},onReady:function(){this.create_or_onready()},methods:{create_or_onready:function(){var e=this,n=this.username,i=t.getStorageSync("myUsername"),s=n.groupId?n.groupId+i:n.your+i,a=t.getStorageSync(s)||[];this.renderMsg(null,null,a,s),t.setStorageSync(s,null),r.on("em.xmpp.error.sendMsgErr",(function(t){c=t.data.mid,u=!0})),o.on("newChatMsg",(function(t,i,o,r){e.curChatMsg=o,e.visibility&&(n.groupId?t.info.from!=n.groupId&&t.info.to!=n.groupId||r==s&&e.renderMsg(t,i,o,s,"newMsg"):t.info.from!=n.your&&t.info.to!=n.your||r==s&&e.renderMsg(t,i,o,s,"newMsg"))}))},normalScroll:function(){this.view=s.NORMAL},shortScroll:function(){this.scrollTop+=9999,this.$forceUpdate()},onTap:function(){this.$emit("msglistTap")},previewImage:function(e){var n=e.target.dataset.url;t.previewImage({urls:[n]})},getHistoryMsg:function(){var t=this,e=this.username,n=wx.getStorageSync("myUsername"),i=e.groupId?e.groupId+n:e.your+n,o=wx.getStorageSync("rendered_"+i)||[];if(a<o.length){var r=o.slice(-a,-a-10);this.chatMsg=r.concat(t.chatMsg),a+=10,wx.stopPullDownRefresh()}},renderMsg:function(e,n,i,o,r){i.length>1&&this.chatMsg.map((function(t,e){i.map((function(e,n){t.mid==e.mid&&i.splice(n,1)}))}));var s=t.getStorageSync("rendered_"+o)||[];if(s=s.concat(i),s.length){"newMsg"==r?(this.chatMsg=this.chatMsg.concat(i),this.toView=s[s.length-1].mid):(this.chatMsg=s.slice(-10),this.toView=s[s.length-1].mid),t.setStorageSync("rendered_"+o,s);var c=t.getStorageSync(o)||[];c.map((function(t,e){i.map((function(n,i){n.mid==t.mid&&c.splice(e,1)}))})),t.setStorageSync(o,c),a=s.slice(-10).length,u&&this.renderFail(o),this.$forceUpdate(),this.getHeight()}},renderFail:function(e){var n=this,i=n.chatMsg;i.map((function(t){t.mid.substring(t.mid.length-10)==c.substring(c.length-10)&&(t.msg.data[0].isFail=!0,t.isFail=!0,n.chatMsg=i)})),n.curChatMsg[0].mid==c&&(n.curChatMsg[0].msg.data[0].isShow=!1,n.curChatMsg[0].isShow=!1),t.setStorageSync("rendered_"+e,i),u=!1},refresh:function(){},getHeight:function(){var e=this;setTimeout((function(){var n=t.createSelectorQuery().in(e);n.selectAll(".message").boundingClientRect(),n.exec((function(t){t[0].length;e.scrollTop+=9999}))}),0)},toGoodsDetail:function(e){t.navigateTo({url:"/pages/index/goodsDetail?id=".concat(e)})}}};e.default=l}).call(this,n("543d")["default"])},"29c0":function(t,e,n){"use strict";var i=n("8efe"),o=n.n(i);o.a},4144:function(t,e,n){"use strict";n.r(e);var i=n("8e80"),o=n("aea3");for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);n("29c0");var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=c.exports},"8e80":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}));var o=function(){var t=this,e=t.$createElement;t._self._c},r=[]},"8efe":function(t,e,n){},aea3:function(t,e,n){"use strict";n.r(e);var i=n("1763"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'comps/chat/msglist/msglist-create-component',
    {
        'comps/chat/msglist/msglist-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("4144"))
        })
    },
    [['comps/chat/msglist/msglist-create-component']]
]);
