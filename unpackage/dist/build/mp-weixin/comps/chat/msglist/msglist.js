(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["comps/chat/msglist/msglist"],{1763:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){Promise.all([n.e("common/vendor"),n.e("comps/chat/msglist/type/audio/audio")]).then(function(){return resolve(n("50ed"))}.bind(null,n)).catch(n.oe)},r=n("7657"),o=n("ac99"),s={SHORT:"scroll_view_change",NORMAL:"scroll_view"},a=0,c="",u=!1,l={components:{audioMsg:i},props:{username:{type:Object,value:{}}},data:function(){return{view:s.NORMAL,toView:"",chatMsg:[],visibility:!1,scrollTop:99999}},beforeMount:function(){this.visibility=!0,0,a=0},beforeDestroy:function(){this.visibility=!1},created:function(){this.create_or_onready()},onReady:function(){this.create_or_onready()},methods:{create_or_onready:function(){var e=this,n=this.username,i=t.getStorageSync("myUsername"),s=n.groupId?n.groupId+i:n.your+i;console.log(s);var a=t.getStorageSync(s)||[];console.log(a),this.renderMsg(null,null,a,s),t.setStorageSync(s,null),o.on("em.xmpp.error.sendMsgErr",(function(t){c=t.data.mid,u=!0})),r.on("newChatMsg",(function(t,i,r,o){e.curChatMsg=r,e.visibility&&(n.groupId?t.info.from!=n.groupId&&t.info.to!=n.groupId||o==s&&e.renderMsg(t,i,r,s,"newMsg"):t.info.from!=n.your&&t.info.to!=n.your||o==s&&e.renderMsg(t,i,r,s,"newMsg"))}))},normalScroll:function(){this.view=s.NORMAL},shortScroll:function(){this.scrollTop+=9999,this.$forceUpdate()},onTap:function(){this.$emit("msglistTap")},previewImage:function(e){var n=e.target.dataset.url;t.previewImage({urls:[n]})},getHistoryMsg:function(){var t=this,e=this.username,n=wx.getStorageSync("myUsername"),i=e.groupId?e.groupId+n:e.your+n,r=wx.getStorageSync("rendered_"+i)||[];if(a<r.length){var o=r.slice(-a,-a-10);this.chatMsg=o.concat(t.chatMsg),a+=10,wx.stopPullDownRefresh()}},renderMsg:function(e,n,i,r,o){i.length>1&&this.chatMsg.map((function(t,e){i.map((function(e,n){t.mid==e.mid&&i.splice(n,1)}))}));var s=t.getStorageSync("rendered_"+r)||[];if(s=s.concat(i),s.length){"newMsg"==o?(this.chatMsg=this.chatMsg.concat(i),this.toView=s[s.length-1].mid):(this.chatMsg=s.slice(-10),this.toView=s[s.length-1].mid),t.setStorageSync("rendered_"+r,s);var c=t.getStorageSync(r)||[];c.map((function(t,e){i.map((function(n,i){n.mid==t.mid&&c.splice(e,1)}))})),t.setStorageSync(r,c),a=s.slice(-10).length,u&&this.renderFail(r),this.$forceUpdate(),this.getHeight()}},renderFail:function(e){var n=this,i=n.chatMsg;i.map((function(t){t.mid.substring(t.mid.length-10)==c.substring(c.length-10)&&(t.msg.data[0].isFail=!0,t.isFail=!0,n.chatMsg=i)})),n.curChatMsg[0].mid==c&&(n.curChatMsg[0].msg.data[0].isShow=!1,n.curChatMsg[0].isShow=!1),t.setStorageSync("rendered_"+e,i),u=!1},refresh:function(){},getHeight:function(){var e=this;setTimeout((function(){var n=t.createSelectorQuery().in(e);n.selectAll(".message").boundingClientRect(),n.exec((function(t){var n=t[0].length;e.scrollTop+=t[0][n-1].height}))}),0)}}};e.default=l}).call(this,n("543d")["default"])},"29c0":function(t,e,n){"use strict";var i=n("8efe"),r=n.n(i);r.a},4144:function(t,e,n){"use strict";n.r(e);var i=n("ea10"),r=n("aea3");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n("29c0");var s,a=n("f0c5"),c=Object(a["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=c.exports},"8efe":function(t,e,n){},aea3:function(t,e,n){"use strict";n.r(e);var i=n("1763"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},ea10:function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'comps/chat/msglist/msglist-create-component',
    {
        'comps/chat/msglist/msglist-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("4144"))
        })
    },
    [['comps/chat/msglist/msglist-create-component']]
]);
